archive: true
language: java
jdk:
  - oraclejdk8

build:
  pre_ci_boot:
    image_name: menny/android_ndk
    image_tag: latest
    pull: true
  env:
    global:
    - secure: KDs/slK8Wd05ulx6mZ4of8zQny1gzlcxZdP3Sft/uiwtvFGvk7N3k66D9WjVrfvNzO6NLrolVeCvwWQd/EX1PwqKXO3KVvVvzwORnYLvkDBQUu8t1igFaCSDZaW8Ua0bFi7IvUuVpv6h5X+y8qvxjbKmdUvTbxHwPp8DWlcjSjFOgSvF3V+sk6ioHwnLqnlDVlO88uhMJBfUX2aOD9JHvkR673PTpRRNfWbG83M49CeUkc9Dei2loFiBCWLkchF1hOsII6AB4ZVvSov4OwLzSdomVPTh/b1qjSZMs+gCAMLNS/zfNVeUhlKRnn0BjiDu1/jgLg19UuKiiZYo4CaReE482CRPF/Sd9z00tTWHw/cHJNHlICCfUjsuHODSfP8WB8sdXPnDOM0rcGN8tcbStfrtzKHDRgQynKZaXY63/yxl7gYsfdF24kOL5DA0h40FY0aZBLeG4AWxq1t4yVsYf0eg31qDHKXh54g/m9R/VmpOyI5rq4xKSrvcf3X4urLgklTZ/Vxj5VQ+HXWuEBWwhV+HRCH1gCff0vypuN8EYMEk2SFmY/mGymY3js4EcuU7O3T24MF/nmM5ADJxi3kZT+7R5bRXGugOsADpODzhdYHF7ndGB1xfmSmrFrIwwffqSTqbKXYNGE3ofGL+YiOQiwoEDLlkT7U+Ma1elHY3hl4=
  ci:
    - mkdir -p shippable/testresults
    - mkdir -p shippable/codecoverage
    - ./download_signing_files.sh $ANYSOFTKEYBOARD_KEYSTORE_ALIAS
    - ./gradlew clean testDebug checkDebug
    - ./gradlew jacocoTestReport
    - cp -r build/test-results/* shippable/testresults/
    - cp -r build/jacoco/* shippable/codecoverage/
    - cp -r build/reports/jacoco/jacocoTestReport/* shippable/codecoverage/
    - ./gradlew clean assembleCanary publishCanary -PenableApkPublish
    - cp build/outputs/apk/* shippable/
    - ./gradlew clean assembleRelease assembleDebug
    - cp build/outputs/apk/* shippable/
integrations:
    notifications:
        - integrationName: email
          type: email
          recipients:
            - mennyed@gmail.com
          on_success: always
          on_failure: always
